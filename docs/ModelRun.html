<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Running the model | A Quick Introduction to bbsBayes</title>
  <meta name="description" content="This is a document to support a ~2hr workshop." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Running the model | A Quick Introduction to bbsBayes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a document to support a ~2hr workshop." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Running the model | A Quick Introduction to bbsBayes" />
  
  <meta name="twitter:description" content="This is a document to support a ~2hr workshop." />
  

<meta name="author" content="Adam C. Smith, and Brandon P.M. Edwards" />


<meta name="date" content="2020-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="DataPrep.html"/>
<link rel="next" href="IndicesTrends.html"/>
<script src="libs/header-attrs-2.4.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Quick Introduction to bbsBayes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Customized BBS trends, trajectories, graphs, and maps using the bbsBayes R-package, an Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-the-workshop-about"><i class="fa fa-check"></i><b>1.1</b> What is the workshop about?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#intended-audience"><i class="fa fa-check"></i><b>1.2</b> Intended Audience</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#what-we-hope-you-will-learn-here"><i class="fa fa-check"></i><b>1.3</b> What we hope you will learn here</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Intro.html"><a href="Intro.html"><i class="fa fa-check"></i><b>2</b> Preparation and Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Intro.html"><a href="Intro.html#pre-workshop-preparation"><i class="fa fa-check"></i><b>2.1</b> Pre-Workshop preparation</a></li>
<li class="chapter" data-level="2.2" data-path="Intro.html"><a href="Intro.html#installation"><i class="fa fa-check"></i><b>2.2</b> Installation</a></li>
<li class="chapter" data-level="2.3" data-path="Intro.html"><a href="Intro.html#data-retrieval"><i class="fa fa-check"></i><b>2.3</b> Data Retrieval</a></li>
<li class="chapter" data-level="2.4" data-path="Intro.html"><a href="Intro.html#install-jags"><i class="fa fa-check"></i><b>2.4</b> Install JAGS</a></li>
<li class="chapter" data-level="2.5" data-path="Intro.html"><a href="Intro.html#example-data-for-scarlet-tanager"><i class="fa fa-check"></i><b>2.5</b> Example data for Scarlet Tanager</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Stratify.html"><a href="Stratify.html"><i class="fa fa-check"></i><b>3</b> Stratification</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Stratify.html"><a href="Stratify.html#strata"><i class="fa fa-check"></i><b>3.1</b> Strata</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Stratify.html"><a href="Stratify.html#useful-code-to-access-and-print-the-strata-maps-above"><i class="fa fa-check"></i><b>3.1.1</b> Useful code to access and print the strata maps above</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="DataPrep.html"><a href="DataPrep.html"><i class="fa fa-check"></i><b>4</b> Prepare the data for a model and species</a>
<ul>
<li class="chapter" data-level="4.1" data-path="DataPrep.html"><a href="DataPrep.html#prepare-data"><i class="fa fa-check"></i><b>4.1</b> Prepare data</a></li>
<li class="chapter" data-level="4.2" data-path="DataPrep.html"><a href="DataPrep.html#models"><i class="fa fa-check"></i><b>4.2</b> Models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="DataPrep.html"><a href="DataPrep.html#slope"><i class="fa fa-check"></i><b>4.2.1</b> slope</a></li>
<li class="chapter" data-level="4.2.2" data-path="DataPrep.html"><a href="DataPrep.html#gam"><i class="fa fa-check"></i><b>4.2.2</b> gam</a></li>
<li class="chapter" data-level="4.2.3" data-path="DataPrep.html"><a href="DataPrep.html#gamye"><i class="fa fa-check"></i><b>4.2.3</b> gamye</a></li>
<li class="chapter" data-level="4.2.4" data-path="DataPrep.html"><a href="DataPrep.html#firstdiff"><i class="fa fa-check"></i><b>4.2.4</b> firstdiff</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="DataPrep.html"><a href="DataPrep.html#cws-analysis-example"><i class="fa fa-check"></i><b>4.3</b> CWS analysis example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ModelRun.html"><a href="ModelRun.html"><i class="fa fa-check"></i><b>5</b> Running the model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ModelRun.html"><a href="ModelRun.html#pacfic-wren-example"><i class="fa fa-check"></i><b>5.1</b> Pacfic Wren example</a></li>
<li class="chapter" data-level="5.2" data-path="ModelRun.html"><a href="ModelRun.html#convergence-of-the-mcmc"><i class="fa fa-check"></i><b>5.2</b> Convergence of the MCMC</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="IndicesTrends.html"><a href="IndicesTrends.html"><i class="fa fa-check"></i><b>6</b> Estimating Annual Indices and Trends</a>
<ul>
<li class="chapter" data-level="6.1" data-path="IndicesTrends.html"><a href="IndicesTrends.html#annual-indices"><i class="fa fa-check"></i><b>6.1</b> Annual Indices</a></li>
<li class="chapter" data-level="6.2" data-path="IndicesTrends.html"><a href="IndicesTrends.html#population-trends"><i class="fa fa-check"></i><b>6.2</b> Population Trends</a></li>
<li class="chapter" data-level="6.3" data-path="IndicesTrends.html"><a href="IndicesTrends.html#alternative-time-spans-for-trends"><i class="fa fa-check"></i><b>6.3</b> Alternative time-spans for trends</a></li>
<li class="chapter" data-level="6.4" data-path="IndicesTrends.html"><a href="IndicesTrends.html#alternative-definitions-of-trends"><i class="fa fa-check"></i><b>6.4</b> Alternative definitions of trends</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="IndicesTrends.html"><a href="IndicesTrends.html#percent-change-and-probability-of-change"><i class="fa fa-check"></i><b>6.4.1</b> Percent Change and probability of change</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="IndicesTrends.html"><a href="IndicesTrends.html#changing-trends-through-time"><i class="fa fa-check"></i><b>6.5</b> Changing trends through time</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="GraphMap.html"><a href="GraphMap.html"><i class="fa fa-check"></i><b>7</b> Trajectory graphs and trend maps</a>
<ul>
<li class="chapter" data-level="7.1" data-path="GraphMap.html"><a href="GraphMap.html#graphing-the-trajectories-annual-indices"><i class="fa fa-check"></i><b>7.1</b> Graphing the trajectories (annual indices)</a></li>
<li class="chapter" data-level="7.2" data-path="GraphMap.html"><a href="GraphMap.html#adding-elements-to-indices-plots"><i class="fa fa-check"></i><b>7.2</b> Adding elements to indices plots</a></li>
<li class="chapter" data-level="7.3" data-path="GraphMap.html"><a href="GraphMap.html#mapping-the-trends"><i class="fa fa-check"></i><b>7.3</b> Mapping the trends</a></li>
<li class="chapter" data-level="7.4" data-path="GraphMap.html"><a href="GraphMap.html#geofacet-trajectories"><i class="fa fa-check"></i><b>7.4</b> Geofacet Trajectories</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Adv.html"><a href="Adv.html"><i class="fa fa-check"></i><b>8</b> Advanced options</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Adv.html"><a href="Adv.html#custom-regional-summaries"><i class="fa fa-check"></i><b>8.1</b> Custom regional summaries</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="Adv.html"><a href="Adv.html#define-the-custom-regions-as-a-collection-of-the-existing-strata."><i class="fa fa-check"></i><b>8.1.1</b> Define the custom regions as a collection of the existing strata.</a></li>
<li class="chapter" data-level="8.1.2" data-path="Adv.html"><a href="Adv.html#use-defined-regions-to-estimate-indices-and-trends"><i class="fa fa-check"></i><b>8.1.2</b> Use defined regions to estimate indices and trends</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="Adv.html"><a href="Adv.html#exporting-the-jags-model"><i class="fa fa-check"></i><b>8.2</b> Exporting the JAGS model</a></li>
<li class="chapter" data-level="8.3" data-path="Adv.html"><a href="Adv.html#customizing-the-jags-model-and-data"><i class="fa fa-check"></i><b>8.3</b> Customizing the JAGS model and data</a></li>
<li class="chapter" data-level="8.4" data-path="Adv.html"><a href="Adv.html#comparing-models"><i class="fa fa-check"></i><b>8.4</b> Comparing Models</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Ref.html"><a href="Ref.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Quick Introduction to bbsBayes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ModelRun" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Running the model</h1>
<p>After stratifying and preparing the data for a particular species and model, the <code>run_model()</code> function calls the JAGS program to fit the selected model to the species’ data.</p>
<p>Depending on the model and the size of the dataset (number of counts, number of strata, number of years, etc.), this process can take a long time (hours - days). The following code shows the settings used for most species in the annual CWS analysis.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="ModelRun.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Not Run</span></span>
<span id="cb12-2"><a href="ModelRun.html#cb12-2" aria-hidden="true" tabindex="-1"></a>jags_mod <span class="ot">&lt;-</span> <span class="fu">run_model</span>(<span class="at">jags_data =</span> jags_data,</span>
<span id="cb12-3"><a href="ModelRun.html#cb12-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_iter =</span> <span class="dv">24000</span>, <span class="co">#higher than the default 10,000</span></span>
<span id="cb12-4"><a href="ModelRun.html#cb12-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_burnin =</span> <span class="dv">20000</span>,</span>
<span id="cb12-5"><a href="ModelRun.html#cb12-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_chains =</span> <span class="dv">3</span>,</span>
<span id="cb12-6"><a href="ModelRun.html#cb12-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_thin =</span> <span class="dv">20</span>, <span class="co">#saves memory by retaining only 1/20 posterior samples</span></span>
<span id="cb12-7"><a href="ModelRun.html#cb12-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-8"><a href="ModelRun.html#cb12-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">inits =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-9"><a href="ModelRun.html#cb12-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parameters_to_save =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;n3&quot;</span>,<span class="st">&quot;nu&quot;</span>,</span>
<span id="cb12-10"><a href="ModelRun.html#cb12-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">&quot;B.X&quot;</span>,<span class="st">&quot;beta.X&quot;</span>,<span class="st">&quot;strata&quot;</span>,</span>
<span id="cb12-11"><a href="ModelRun.html#cb12-11" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">&quot;sdbeta&quot;</span>,<span class="st">&quot;sdX&quot;</span>,<span class="st">&quot;alpha&quot;</span>))</span>
<span id="cb12-12"><a href="ModelRun.html#cb12-12" aria-hidden="true" tabindex="-1"></a> </span></code></pre></div>
<p>There is only one critical argument in the <code>run_model()</code> function.</p>
<ul>
<li>jags_data - List output from the <code>prepare_jags_data()</code> function.</li>
</ul>
<p>The remaining arguments allow for some customization of the MCMC process. The default settings are sufficient for many species and model combinations, but here is some explanation of the arguments that many users may want to modify:</p>
<ul>
<li><p>parameters_to_save - Character vector of parameters to monitor in JAGS. Defaults to just monitoring “n,” the annual indices of abundance that make up the estimated population trajectories in each stratum. In the two models with separate parameters for the year-effects and the long-term change (“gamye” and “slope”), there is an optional version of the annual indices of abundance called “n3,” which tracks the population trajectory after removing the year-effects. This “n3” parameter represents the smooth-only population trajectory from the gamye and the linear-slope component of the trajectory from the slope model. In the CWS annual analyses, the “n3” parameter is used to estimate trends and the “n” parameter is used to track the full population trajectory.</p></li>
<li><p>n_chains - Optional number of chains to run. Defaults to 3.</p></li>
<li><p>n_burnin - Optional integer specifying the number of iterations to burn in the model. Defaults to 20000 per chain.</p></li>
<li><p>n_thin - Optional number of steps to thin or discard. Defaults to 10</p></li>
<li><p>n_iter - Optional number of iterations per chain. Defaults to 10000.</p></li>
<li><p>parallel - Logical, Should each chain be run in parallel on separate cores? If TRUE, the number of cores used will be the minimum of the n_chains specified and the number of cores on your computer</p></li>
</ul>
<div id="pacfic-wren-example" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Pacfic Wren example</h2>
<p>Here’s a toy example using data for the Pacific Wren and the slope model for a shortened time-series:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="ModelRun.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#strat_data &lt;- stratify(by = &quot;bbs_cws&quot;)</span></span>
<span id="cb13-2"><a href="ModelRun.html#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="ModelRun.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the stratified data for use in a JAGS model (see Chapter 4).</span></span>
<span id="cb13-4"><a href="ModelRun.html#cb13-4" aria-hidden="true" tabindex="-1"></a>jags_data <span class="ot">&lt;-</span> <span class="fu">prepare_jags_data</span>(<span class="at">strat_data =</span> strat_data,</span>
<span id="cb13-5"><a href="ModelRun.html#cb13-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">species_to_run =</span> <span class="st">&quot;Pacific Wren&quot;</span>,</span>
<span id="cb13-6"><a href="ModelRun.html#cb13-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">model =</span> <span class="st">&quot;slope&quot;</span>,</span>
<span id="cb13-7"><a href="ModelRun.html#cb13-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">min_year =</span> <span class="dv">2009</span>,</span>
<span id="cb13-8"><a href="ModelRun.html#cb13-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">max_year =</span> <span class="dv">2018</span>)</span>
<span id="cb13-9"><a href="ModelRun.html#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="ModelRun.html#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now run the model</span></span>
<span id="cb13-11"><a href="ModelRun.html#cb13-11" aria-hidden="true" tabindex="-1"></a>jags_mod <span class="ot">&lt;-</span> <span class="fu">run_model</span>(<span class="at">jags_data =</span> jags_data,</span>
<span id="cb13-12"><a href="ModelRun.html#cb13-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_adapt =</span> <span class="dv">100</span>,</span>
<span id="cb13-13"><a href="ModelRun.html#cb13-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_burnin =</span> <span class="dv">200</span>,</span>
<span id="cb13-14"><a href="ModelRun.html#cb13-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_iter =</span> <span class="dv">200</span>,</span>
<span id="cb13-15"><a href="ModelRun.html#cb13-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_thin =</span> <span class="dv">1</span>,</span>
<span id="cb13-16"><a href="ModelRun.html#cb13-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parameters_to_save =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;beta&quot;</span>,<span class="st">&quot;strata&quot;</span>))</span></code></pre></div>
</div>
<div id="convergence-of-the-mcmc" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Convergence of the MCMC</h2>
<p>The <code>run_model()</code> function will send a warning if Gelman-Rubin Rhat cross-chain convergence criterion is &gt; 1.1 for any of the monitored parameters. Re-running the model with a longer burn-in and/or more posterior iterations or greater thinning rates may improve convergence. We can check for ourselves the effective sample size for each monitored parameter, as well as the Rhat values for each monitored parameter:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="ModelRun.html#cb14-1" aria-hidden="true" tabindex="-1"></a>jags_mod<span class="sc">$</span>n.eff <span class="co">#shows the effective sample size for each monitored parameter</span></span>
<span id="cb14-2"><a href="ModelRun.html#cb14-2" aria-hidden="true" tabindex="-1"></a>jags_mod<span class="sc">$</span>Rhat <span class="co"># shows the Rhat values for each monitored parameter</span></span></code></pre></div>
<p>The seriousness of these convergence failures is something the user must interpret for themselves. In some cases some parameters of the model may not be separately estimable, but if there is no direct inference drawn from those separate parameters, their convergence may not be necessary. If all or the vast majority of the n parameters have converged (e.g., you’re receiving this warning message for other monitored parameters), then inference on population trajectories and trends from the model are reliable.</p>
<p>If important monitored parameters have not converged, the shinystan package has some wonderful interactive tools for better understanding convergence issues with MCMC output.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="ModelRun.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;shinystan&quot;)</span></span>
<span id="cb15-2"><a href="ModelRun.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shinystan)</span>
<span id="cb15-3"><a href="ModelRun.html#cb15-3" aria-hidden="true" tabindex="-1"></a>my_sso <span class="ot">&lt;-</span> shinystan<span class="sc">::</span><span class="fu">launch_shinystan</span>(shinystan<span class="sc">::</span><span class="fu">as.shinystan</span>(jags_mod<span class="sc">$</span>samples, <span class="at">model_name =</span> <span class="st">&quot;my_toy_example&quot;</span>))</span></code></pre></div>
<p>bbsBayes also includes a function to help re-start an MCMC chain, so that you avoid having to wait for an additional burn-in period.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="ModelRun.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">### if jags_mod has failed to converge...</span></span>
<span id="cb16-2"><a href="ModelRun.html#cb16-2" aria-hidden="true" tabindex="-1"></a>new_initials <span class="ot">&lt;-</span> <span class="fu">get_final_values</span>(jags_mod)</span>
<span id="cb16-3"><a href="ModelRun.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="ModelRun.html#cb16-4" aria-hidden="true" tabindex="-1"></a>jags_mod2 <span class="ot">&lt;-</span> <span class="fu">run_model</span>(<span class="at">jags_data =</span> jags_data,</span>
<span id="cb16-5"><a href="ModelRun.html#cb16-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_adapt =</span> <span class="dv">0</span>,</span>
<span id="cb16-6"><a href="ModelRun.html#cb16-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_burnin =</span> <span class="dv">0</span>,</span>
<span id="cb16-7"><a href="ModelRun.html#cb16-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_iter =</span> <span class="dv">200</span>,</span>
<span id="cb16-8"><a href="ModelRun.html#cb16-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_thin =</span> <span class="dv">1</span>,</span>
<span id="cb16-9"><a href="ModelRun.html#cb16-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">inits =</span> new_initials,</span>
<span id="cb16-10"><a href="ModelRun.html#cb16-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parameters_to_save =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;beta&quot;</span>,<span class="st">&quot;strata&quot;</span>))</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="DataPrep.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="IndicesTrends.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bbsBayes_Workshop.pdf", "bbsBayes_Workshop.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
